
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nominatim.org/customize/Tokenizers/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.2.5">
    
    
      
        <title>Tokenizers - Nominatim 4.3.0 Manual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extra.css">
    
      <link rel="stylesheet" href="../../styles.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tokenizers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nominatim 4.3.0 Manual" class="md-header__button md-logo" aria-label="Nominatim 4.3.0 Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nominatim 4.3.0 Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tokenizers
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/openstreetmap/Nominatim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Introduction
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../api/Overview/" class="md-tabs__link">
        API Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../admin/Installation/" class="md-tabs__link">
        Administration Guide
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../Overview/" class="md-tabs__link md-tabs__link--active">
        Customization Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../library/Getting-Started/" class="md-tabs__link">
        Library Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../develop/overview/" class="md-tabs__link">
        Developers Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../appendix/Install-on-Ubuntu-20/" class="md-tabs__link">
        Appendix
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nominatim 4.3.0 Manual" class="md-nav__button md-logo" aria-label="Nominatim 4.3.0 Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Nominatim 4.3.0 Manual
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openstreetmap/Nominatim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Search/" class="md-nav__link">
        Search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Reverse/" class="md-nav__link">
        Reverse
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Lookup/" class="md-nav__link">
        Address Lookup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Details/" class="md-nav__link">
        Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Status/" class="md-nav__link">
        Status
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Output/" class="md-nav__link">
        Place Output Formats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Administration Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administration Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Administration Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Installation/" class="md-nav__link">
        Basic Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Import/" class="md-nav__link">
        Import
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Update/" class="md-nav__link">
        Update
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Deployment-PHP/" class="md-nav__link">
        Deploy (PHP frontend)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Deployment-Python/" class="md-nav__link">
        Deploy (Python frontend)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Setup-Nominatim-UI/" class="md-nav__link">
        Nominatim UI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Advanced-Installations/" class="md-nav__link">
        Advanced Installations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Maintenance/" class="md-nav__link">
        Maintenance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Migration/" class="md-nav__link">
        Migration from older Versions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Faq/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Customization Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Customization Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Customization Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Import-Styles/" class="md-nav__link">
        Import Styles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Settings/" class="md-nav__link">
        Configuration Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Country-Settings/" class="md-nav__link">
        Per-Country Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Ranking/" class="md-nav__link">
        Place Ranking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Importance/" class="md-nav__link">
        Importance
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Tokenizers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Tokenizers
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#legacy-tokenizer" class="md-nav__link">
    Legacy tokenizer
  </a>
  
    <nav class="md-nav" aria-label="Legacy tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compiling-the-postgresql-module" class="md-nav__link">
    Compiling the PostgreSQL module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-the-tokenizer" class="md-nav__link">
    Enabling the tokenizer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#icu-tokenizer" class="md-nav__link">
    ICU tokenizer
  </a>
  
    <nav class="md-nav" aria-label="ICU tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    How it works
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#normalization-and-transliteration" class="md-nav__link">
    Normalization and Transliteration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sanitizers" class="md-nav__link">
    Sanitizers
  </a>
  
    <nav class="md-nav" aria-label="Sanitizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#split-name-list" class="md-nav__link">
    split-name-list
  </a>
  
    <nav class="md-nav" aria-label="split-name-list">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.split_name_list" class="md-nav__link">
    nominatim.tokenizer.sanitizers.split_name_list
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strip-brace-terms" class="md-nav__link">
    strip-brace-terms
  </a>
  
    <nav class="md-nav" aria-label="strip-brace-terms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.strip_brace_terms" class="md-nav__link">
    nominatim.tokenizer.sanitizers.strip_brace_terms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-analyzer-by-language" class="md-nav__link">
    tag-analyzer-by-language
  </a>
  
    <nav class="md-nav" aria-label="tag-analyzer-by-language">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.tag_analyzer_by_language" class="md-nav__link">
    nominatim.tokenizer.sanitizers.tag_analyzer_by_language
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-housenumbers" class="md-nav__link">
    clean-housenumbers
  </a>
  
    <nav class="md-nav" aria-label="clean-housenumbers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.clean_housenumbers" class="md-nav__link">
    nominatim.tokenizer.sanitizers.clean_housenumbers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-postcodes" class="md-nav__link">
    clean-postcodes
  </a>
  
    <nav class="md-nav" aria-label="clean-postcodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.clean_postcodes" class="md-nav__link">
    nominatim.tokenizer.sanitizers.clean_postcodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-tiger-tags" class="md-nav__link">
    clean-tiger-tags
  </a>
  
    <nav class="md-nav" aria-label="clean-tiger-tags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.clean_tiger_tags" class="md-nav__link">
    nominatim.tokenizer.sanitizers.clean_tiger_tags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-tags" class="md-nav__link">
    delete-tags
  </a>
  
    <nav class="md-nav" aria-label="delete-tags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.delete_tags" class="md-nav__link">
    nominatim.tokenizer.sanitizers.delete_tags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-japanese" class="md-nav__link">
    tag-japanese
  </a>
  
    <nav class="md-nav" aria-label="tag-japanese">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.tag_japanese" class="md-nav__link">
    nominatim.tokenizer.sanitizers.tag_japanese
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-analysis" class="md-nav__link">
    Token Analysis
  </a>
  
    <nav class="md-nav" aria-label="Token Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generic-token-analyzer" class="md-nav__link">
    Generic token analyzer
  </a>
  
    <nav class="md-nav" aria-label="Generic token analyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variants" class="md-nav__link">
    Variants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decomposition" class="md-nav__link">
    Decomposition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-and-final-terms" class="md-nav__link">
    Initial and final terms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replacements-vs-variants" class="md-nav__link">
    Replacements vs. variants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutations" class="md-nav__link">
    Mutations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modes" class="md-nav__link">
    Modes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#housenumber-token-analyzer" class="md-nav__link">
    Housenumber token analyzer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postcode-token-analyzer" class="md-nav__link">
    Postcode token analyzer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reconfiguration" class="md-nav__link">
    Reconfiguration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Special-Phrases/" class="md-nav__link">
        Special Phrases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Tiger/" class="md-nav__link">
        External data: US housenumbers from TIGER
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Postcodes/" class="md-nav__link">
        External data: Postcodes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Library Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Library Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Library Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Getting-Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../library/NominatimAPI/" class="md-nav__link">
        Nominatim API class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Input-Parameter-Types/" class="md-nav__link">
        Input Parameter Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Result-Handling/" class="md-nav__link">
        Result Handling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Low-Level-DB-Access/" class="md-nav__link">
        Low-level DB Access
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Developers Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developers Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Developers Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/overview/" class="md-nav__link">
        Architecture Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Database-Layout/" class="md-nav__link">
        Database Layout
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Indexing/" class="md-nav__link">
        Indexing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Tokenizers/" class="md-nav__link">
        Tokenizers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/ICU-Tokenizer-Modules/" class="md-nav__link">
        Custom modules for ICU tokenizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Development-Environment/" class="md-nav__link">
        Setup for Development
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/data-sources/" class="md-nav__link">
        External Data Sources
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Appendix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Appendix" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Appendix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/Install-on-Ubuntu-20/" class="md-nav__link">
        Installation on Ubuntu 20
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/Install-on-Ubuntu-22/" class="md-nav__link">
        Installation on Ubuntu 22
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#legacy-tokenizer" class="md-nav__link">
    Legacy tokenizer
  </a>
  
    <nav class="md-nav" aria-label="Legacy tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compiling-the-postgresql-module" class="md-nav__link">
    Compiling the PostgreSQL module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-the-tokenizer" class="md-nav__link">
    Enabling the tokenizer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#icu-tokenizer" class="md-nav__link">
    ICU tokenizer
  </a>
  
    <nav class="md-nav" aria-label="ICU tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    How it works
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#normalization-and-transliteration" class="md-nav__link">
    Normalization and Transliteration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sanitizers" class="md-nav__link">
    Sanitizers
  </a>
  
    <nav class="md-nav" aria-label="Sanitizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#split-name-list" class="md-nav__link">
    split-name-list
  </a>
  
    <nav class="md-nav" aria-label="split-name-list">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.split_name_list" class="md-nav__link">
    nominatim.tokenizer.sanitizers.split_name_list
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strip-brace-terms" class="md-nav__link">
    strip-brace-terms
  </a>
  
    <nav class="md-nav" aria-label="strip-brace-terms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.strip_brace_terms" class="md-nav__link">
    nominatim.tokenizer.sanitizers.strip_brace_terms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-analyzer-by-language" class="md-nav__link">
    tag-analyzer-by-language
  </a>
  
    <nav class="md-nav" aria-label="tag-analyzer-by-language">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.tag_analyzer_by_language" class="md-nav__link">
    nominatim.tokenizer.sanitizers.tag_analyzer_by_language
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-housenumbers" class="md-nav__link">
    clean-housenumbers
  </a>
  
    <nav class="md-nav" aria-label="clean-housenumbers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.clean_housenumbers" class="md-nav__link">
    nominatim.tokenizer.sanitizers.clean_housenumbers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-postcodes" class="md-nav__link">
    clean-postcodes
  </a>
  
    <nav class="md-nav" aria-label="clean-postcodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.clean_postcodes" class="md-nav__link">
    nominatim.tokenizer.sanitizers.clean_postcodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-tiger-tags" class="md-nav__link">
    clean-tiger-tags
  </a>
  
    <nav class="md-nav" aria-label="clean-tiger-tags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.clean_tiger_tags" class="md-nav__link">
    nominatim.tokenizer.sanitizers.clean_tiger_tags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-tags" class="md-nav__link">
    delete-tags
  </a>
  
    <nav class="md-nav" aria-label="delete-tags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.delete_tags" class="md-nav__link">
    nominatim.tokenizer.sanitizers.delete_tags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-japanese" class="md-nav__link">
    tag-japanese
  </a>
  
    <nav class="md-nav" aria-label="tag-japanese">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nominatim.tokenizer.sanitizers.tag_japanese" class="md-nav__link">
    nominatim.tokenizer.sanitizers.tag_japanese
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-analysis" class="md-nav__link">
    Token Analysis
  </a>
  
    <nav class="md-nav" aria-label="Token Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generic-token-analyzer" class="md-nav__link">
    Generic token analyzer
  </a>
  
    <nav class="md-nav" aria-label="Generic token analyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variants" class="md-nav__link">
    Variants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decomposition" class="md-nav__link">
    Decomposition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-and-final-terms" class="md-nav__link">
    Initial and final terms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replacements-vs-variants" class="md-nav__link">
    Replacements vs. variants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutations" class="md-nav__link">
    Mutations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modes" class="md-nav__link">
    Modes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#housenumber-token-analyzer" class="md-nav__link">
    Housenumber token analyzer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postcode-token-analyzer" class="md-nav__link">
    Postcode token analyzer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reconfiguration" class="md-nav__link">
    Reconfiguration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/openstreetmap/Nominatim/edit/master/docs/customize/Tokenizers.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="tokenizers">Tokenizers<a class="headerlink" href="#tokenizers" title="Permanent link"></a></h1>
<p>The tokenizer module in Nominatim is responsible for analysing the names given
to OSM objects and the terms of an incoming query in order to make sure, they
can be matched appropriately.</p>
<p>Nominatim offers different tokenizer modules, which behave differently and have
different configuration options. This sections describes the tokenizers and how
they can be configured.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The use of a tokenizer is tied to a database installation. You need to choose
and configure the tokenizer before starting the initial import. Once the import
is done, you cannot switch to another tokenizer anymore. Reconfiguring the
chosen tokenizer is very limited as well. See the comments in each tokenizer
section.</p>
</div>
<h2 id="legacy-tokenizer">Legacy tokenizer<a class="headerlink" href="#legacy-tokenizer" title="Permanent link"></a></h2>
<p>The legacy tokenizer implements the analysis algorithms of older Nominatim
versions. It uses a special Postgresql module to normalize names and queries.
This tokenizer is automatically installed and used when upgrading an older
database. It should not be used for new installations anymore.</p>
<h3 id="compiling-the-postgresql-module">Compiling the PostgreSQL module<a class="headerlink" href="#compiling-the-postgresql-module" title="Permanent link"></a></h3>
<p>The tokeinzer needs a special C module for PostgreSQL which is not compiled
by default. If you need the legacy tokenizer, compile Nominatim as follows:</p>
<div class="highlight"><pre><span></span><code>mkdir build
cd build
cmake -DBUILD_MODULE=on
make
</code></pre></div>
<h3 id="enabling-the-tokenizer">Enabling the tokenizer<a class="headerlink" href="#enabling-the-tokenizer" title="Permanent link"></a></h3>
<p>To enable the tokenizer add the following line to your project configuration:</p>
<div class="highlight"><pre><span></span><code>NOMINATIM_TOKENIZER=legacy
</code></pre></div>
<p>The Postgresql module for the tokenizer is available in the <code>module</code> directory
and also installed with the remainder of the software under
<code>lib/nominatim/module/nominatim.so</code>. You can specify a custom location for
the module with</p>
<div class="highlight"><pre><span></span><code>NOMINATIM_DATABASE_MODULE_PATH=&lt;path to directory where nominatim.so resides&gt;
</code></pre></div>
<p>This is in particular useful when the database runs on a different server.
See <a href="../../admin/Advanced-Installations/#importing-nominatim-to-an-external-postgresql-database">Advanced installations</a> for details.</p>
<p>There are no other configuration options for the legacy tokenizer. All
normalization functions are hard-coded.</p>
<h2 id="icu-tokenizer">ICU tokenizer<a class="headerlink" href="#icu-tokenizer" title="Permanent link"></a></h2>
<p>The ICU tokenizer uses the <a href="http://site.icu-project.org/">ICU library</a> to
normalize names and queries. It also offers configurable decomposition and
abbreviation handling.
This tokenizer is currently the default.</p>
<p>To enable the tokenizer add the following line to your project configuration:</p>
<div class="highlight"><pre><span></span><code>NOMINATIM_TOKENIZER=icu
</code></pre></div>
<h3 id="how-it-works">How it works<a class="headerlink" href="#how-it-works" title="Permanent link"></a></h3>
<p>On import the tokenizer processes names in the following three stages:</p>
<ol>
<li>During the <strong>Sanitizer step</strong> incoming names are cleaned up and converted to
   <strong>full names</strong>. This step can be used to regularize spelling, split multi-name
   tags into their parts and tag names with additional attributes. See the
   <a href="#sanitizers">Sanitizers section</a> below for available cleaning routines.</li>
<li>The <strong>Normalization</strong> part removes all information from the full names
   that are not relevant for search.</li>
<li>The <strong>Token analysis</strong> step takes the normalized full names and creates
   all transliterated variants under which the name should be searchable.
   See the <a href="#token-analysis">Token analysis</a> section below for more
   information.</li>
</ol>
<p>During query time, only normalization and transliteration are relevant.
An incoming query is first split into name chunks (this usually means splitting
the string at the commas) and the each part is normalised and transliterated.
The result is used to look up places in the search index.</p>
<h3 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link"></a></h3>
<p>The ICU tokenizer is configured using a YAML file which can be configured using
<code>NOMINATIM_TOKENIZER_CONFIG</code>. The configuration is read on import and then
saved as part of the internal database status. Later changes to the variable
have no effect.</p>
<p>Here is an example configuration file:</p>
<div class="highlight"><pre><span></span><code><span class="nt">normalization</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;::</span><span class="nv"> </span><span class="s">lower</span><span class="nv"> </span><span class="s">()&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;ß</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">&#39;ss&#39;&quot;</span><span class="w"> </span><span class="c1"># German szet is unambiguously equal to double ss</span>
<span class="nt">transliteration</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!include</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/nominatim/icu-rules/extended-unicode-to-asccii.yaml</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;::</span><span class="nv"> </span><span class="s">Ascii</span><span class="nv"> </span><span class="s">()&quot;</span>
<span class="nt">sanitizers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">split-name-list</span>
<span class="nt">token-analysis</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">analyzer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generic</span>
<span class="w">      </span><span class="nt">variants</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!include</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">icu-rules/variants-ca.yaml</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">words</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">road -&gt; rd</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge -&gt; bdge,br,brdg,bri,brg</span>
<span class="w">      </span><span class="nt">mutations</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;ä&#39;</span>
<span class="w">            </span><span class="nt">replacements</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ä&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ae&#39;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>The configuration file contains four sections:
<code>normalization</code>, <code>transliteration</code>, <code>sanitizers</code> and <code>token-analysis</code>.</p>
<h4 id="normalization-and-transliteration">Normalization and Transliteration<a class="headerlink" href="#normalization-and-transliteration" title="Permanent link"></a></h4>
<p>The normalization and transliteration sections each define a set of
ICU rules that are applied to the names.</p>
<p>The <strong>normalization</strong> rules are applied after sanitation. They should remove
any information that is not relevant for search at all. Usual rules to be
applied here are: lower-casing, removing of special characters, cleanup of
spaces.</p>
<p>The <strong>transliteration</strong> rules are applied at the end of the tokenization
process to transfer the name into an ASCII representation. Transliteration can
be useful to allow for further fuzzy matching, especially between different
scripts.</p>
<p>Each section must contain a list of
<a href="https://unicode-org.github.io/icu/userguide/transforms/general/rules.html">ICU transformation rules</a>.
The rules are applied in the order in which they appear in the file.
You can also include additional rules from external yaml file using the
<code>!include</code> tag. The included file must contain a valid YAML list of ICU rules
and may again include other files.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The ICU rule syntax contains special characters that conflict with the
YAML syntax. You should therefore always enclose the ICU rules in
double-quotes.</p>
</div>
<h4 id="sanitizers">Sanitizers<a class="headerlink" href="#sanitizers" title="Permanent link"></a></h4>
<p>The sanitizers section defines an ordered list of functions that are applied
to the name and address tags before they are further processed by the tokenizer.
They allows to clean up the tagging and bring it to a standardized form more
suitable for building the search index.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Sanitizers only have an effect on how the search index is built. They
do not change the information about each place that is saved in the
database. In particular, they have no influence on how the results are
displayed. The returned results always show the original information as
stored in the OpenStreetMap database.</p>
</div>
<p>Each entry contains information of a sanitizer to be applied. It has a
mandatory parameter <code>step</code> which gives the name of the sanitizer. Depending
on the type, it may have additional parameters to configure its operation.</p>
<p>The order of the list matters. The sanitizers are applied exactly in the order
that is configured. Each sanitizer works on the results of the previous one.</p>
<p>The following is a list of sanitizers that are shipped with Nominatim.</p>
<h5 id="split-name-list">split-name-list<a class="headerlink" href="#split-name-list" title="Permanent link"></a></h5>


<div class="doc doc-object doc-module">


<a id="nominatim.tokenizer.sanitizers.split_name_list"></a>
  <div class="doc doc-contents first">
  
      <p>Sanitizer that splits lists of names into their components.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>delimiters</code></td>
          <td class="doc-param-details">
            <p>Define the set of characters to be used for
        splitting the list. (default: ',;')</p>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h5 id="strip-brace-terms">strip-brace-terms<a class="headerlink" href="#strip-brace-terms" title="Permanent link"></a></h5>


<div class="doc doc-object doc-module">


<a id="nominatim.tokenizer.sanitizers.strip_brace_terms"></a>
  <div class="doc doc-contents first">
  
      <p>This sanitizer creates additional name variants for names that have
addendums in brackets (e.g. "Halle (Saale)"). The additional variant contains
only the main name part with the bracket part removed.</p>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h5 id="tag-analyzer-by-language">tag-analyzer-by-language<a class="headerlink" href="#tag-analyzer-by-language" title="Permanent link"></a></h5>


<div class="doc doc-object doc-module">


<a id="nominatim.tokenizer.sanitizers.tag_analyzer_by_language"></a>
  <div class="doc doc-contents first">
  
      <p>This sanitizer sets the <code>analyzer</code> property depending on the
language of the tag. The language is taken from the suffix of the name.
If a name already has an analyzer tagged, then this is kept.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filter-kind</code></td>
          <td class="doc-param-details">
            <p>Restrict the names the sanitizer should be applied to
         the given tags. The parameter expects a list of
         regular expressions which are matched against 'kind'.
         Note that a match against the full string is expected.</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>whitelist</code></td>
          <td class="doc-param-details">
            <p>Restrict the set of languages that should be tagged.
       Expects a list of acceptable suffixes. When unset,
       all 2- and 3-letter lower-case codes are accepted.</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>use-defaults</code></td>
          <td class="doc-param-details">
            <p>Configure what happens when the name has no suffix.
           When set to 'all', a variant is created for
           each of the default languages in the country
           the feature is in. When set to 'mono', a variant is
           only created, when exactly one language is spoken
           in the country. The default is to do nothing with
           the default languages of a country.</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>mode</code></td>
          <td class="doc-param-details">
            <p>Define how the variants are created and may be 'replace' or
  'append'. When set to 'append' the original name (without
  any analyzer tagged) is retained. (default: replace)</p>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h5 id="clean-housenumbers">clean-housenumbers<a class="headerlink" href="#clean-housenumbers" title="Permanent link"></a></h5>


<div class="doc doc-object doc-module">


<a id="nominatim.tokenizer.sanitizers.clean_housenumbers"></a>
  <div class="doc doc-contents first">
  
      <p>Sanitizer that preprocesses address tags for house numbers. The sanitizer
allows to</p>
<ul>
<li>define which tags are to be considered house numbers (see 'filter-kind')</li>
<li>split house number lists into individual numbers (see 'delimiters')</li>
</ul>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>delimiters</code></td>
          <td class="doc-param-details">
            <p>Define the set of characters to be used for
        splitting a list of house numbers into parts. (default: ',;')</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>filter-kind</code></td>
          <td class="doc-param-details">
            <p>Define the address tags that are considered to be a
         house number. Either takes a single string or a list of strings,
         where each string is a regular expression. An address item
         is considered a house number if the 'kind' fully matches any
         of the given regular expressions. (default: 'housenumber')</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>convert-to-name</code></td>
          <td class="doc-param-details">
            <p>Define house numbers that should be treated as a name
             instead of a house number. Either takes a single string
             or a list of strings, where each string is a regular
             expression that must match the full house number value.</p>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h5 id="clean-postcodes">clean-postcodes<a class="headerlink" href="#clean-postcodes" title="Permanent link"></a></h5>


<div class="doc doc-object doc-module">


<a id="nominatim.tokenizer.sanitizers.clean_postcodes"></a>
  <div class="doc doc-contents first">
  
      <p>Sanitizer that filters postcodes by their officially allowed pattern.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>convert-to-address</code></td>
          <td class="doc-param-details">
            <p>If set to 'yes' (the default), then postcodes that do
                not conform with their country-specific pattern are
                converted to an address component. That means that
                the postcode does not take part when computing the
                postcode centroids of a country but is still searchable.
                When set to 'no', non-conforming postcodes are not
                searchable either.</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>default-pattern</code></td>
          <td class="doc-param-details">
            <p>Pattern to use, when there is none available for the
                country in question. Warning: will not be used for
                objects that have no country assigned. These are always
                assumed to have no postcode.</p>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h5 id="clean-tiger-tags">clean-tiger-tags<a class="headerlink" href="#clean-tiger-tags" title="Permanent link"></a></h5>


<div class="doc doc-object doc-module">


<a id="nominatim.tokenizer.sanitizers.clean_tiger_tags"></a>
  <div class="doc doc-contents first">
  
      <p>Sanitizer that preprocesses tags from the TIGER import.</p>
<p>It makes the following changes:</p>
<ul>
<li>remove state reference from tiger:county</li>
</ul>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h4 id="delete-tags">delete-tags<a class="headerlink" href="#delete-tags" title="Permanent link"></a></h4>


<div class="doc doc-object doc-module">


<a id="nominatim.tokenizer.sanitizers.delete_tags"></a>
  <div class="doc doc-contents first">
  
      <p>Sanitizer which prevents certain tags from getting into the search index.
It remove tags which matches all properties given below.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>type</code></td>
          <td class="doc-param-details">
            <p>Define which type of tags should be considered for removal.
  There are two types of tags 'name' and 'address' tags.
  Takes a string 'name' or 'address'. (default: 'name')</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>filter-kind</code></td>
          <td class="doc-param-details">
            <p>Define which 'kind' of tags should be removed.
         Takes a string or list of strings where each
         string is a regular expression. A tag is considered
         to be a candidate for removal if its 'kind' property
         fully matches any of the given regular expressions.
         Note that by default all 'kind' of tags are considered.</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>suffix</code></td>
          <td class="doc-param-details">
            <p>Define the 'suffix' property of the tags which should be
    removed. Takes a string or list of strings where each
    string is a regular expression. A tag is considered to be a
    candidate for removal if its 'suffix' property fully
    matches any of the given regular expressions. Note that by
    default tags with any suffix value are considered including
    those which don't have a suffix at all.</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <p>Define the 'name' property corresponding to the 'kind' property
  of the tag. Takes a string or list of strings where each string
  is a regular expression. A tag is considered to be a candidate
  for removal if its name fully matches any of the given regular
  expressions. Note that by default tags with any 'name' are
  considered.</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>country_code</code></td>
          <td class="doc-param-details">
            <p>Define the country code of places whose tags should be
          considered for removed. Takes a string or list of strings
          where each string is a two-letter lower-case country code.
          Note that by default tags of places with any country code
          are considered including those which don't have a country
          code at all.</p>
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>rank_address</code></td>
          <td class="doc-param-details">
            <p>Define the address rank of places whose tags should be
          considered for removal. Takes a string or list of strings
          where each string is a number or range of number or the
          form <from>-<to>.
          Note that default is '0-30', which means that tags of all
          places are considered.
          See https://nominatim.org/release-docs/latest/customize/Ranking/#address-rank
          to learn more about address rank.</p>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h4 id="tag-japanese">tag-japanese<a class="headerlink" href="#tag-japanese" title="Permanent link"></a></h4>


<div class="doc doc-object doc-module">


<a id="nominatim.tokenizer.sanitizers.tag_japanese"></a>
  <div class="doc doc-contents first">
  
      <p>This sanitizer maps OSM data to Japanese block addresses.
It replaces blocknumber and housenumber with housenumber,
and quarter and neighbourhood with place.</p>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h4 id="token-analysis">Token Analysis<a class="headerlink" href="#token-analysis" title="Permanent link"></a></h4>
<p>Token analyzers take a full name and transform it into one or more normalized
form that are then saved in the search index. In its simplest form, the
analyzer only applies the transliteration rules. More complex analyzers
create additional spelling variants of a name. This is useful to handle
decomposition and abbreviation.</p>
<p>The ICU tokenizer may use different analyzers for different names. To select
the analyzer to be used, the name must be tagged with the <code>analyzer</code> attribute
by a sanitizer (see for example the
<a href="#tag-analyzer-by-language">tag-analyzer-by-language sanitizer</a>).</p>
<p>The token-analysis section contains the list of configured analyzers. Each
analyzer must have an <code>id</code> parameter that uniquely identifies the analyzer.
The only exception is the default analyzer that is used when no special
analyzer was selected. There are analysers with special ids:</p>
<ul>
<li>'@housenumber'. If an analyzer with that name is present, it is used
   for normalization of house numbers.</li>
<li>'@potcode'. If an analyzer with that name is present, it is used
   for normalization of postcodes.</li>
</ul>
<p>Different analyzer implementations may exist. To select the implementation,
the <code>analyzer</code> parameter must be set. The different implementations are
described in the following.</p>
<h5 id="generic-token-analyzer">Generic token analyzer<a class="headerlink" href="#generic-token-analyzer" title="Permanent link"></a></h5>
<p>The generic analyzer <code>generic</code> is able to create variants from a list of given
abbreviation and decomposition replacements and introduce spelling variations.</p>
<h6 id="variants">Variants<a class="headerlink" href="#variants" title="Permanent link"></a></h6>
<p>The optional 'variants' section defines lists of replacements which create alternative
spellings of a name. To create the variants, a name is scanned from left to
right and the longest matching replacement is applied until the end of the
string is reached.</p>
<p>The variants section must contain a list of replacement groups. Each group
defines a set of properties that describes where the replacements are
applicable. In addition, the word section defines the list of replacements
to be made. The basic replacement description is of the form:</p>
<div class="highlight"><pre><span></span><code>&lt;source&gt;[,&lt;source&gt;[...]] =&gt; &lt;target&gt;[,&lt;target&gt;[...]]
</code></pre></div>
<p>The left side contains one or more <code>source</code> terms to be replaced. The right side
lists one or more replacements. Each source is replaced with each replacement
term.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The source and target terms are internally normalized using the
normalization rules given in the configuration. This ensures that the
strings match as expected. In fact, it is better to use unnormalized
words in the configuration because then it is possible to change the
rules for normalization later without having to adapt the variant rules.</p>
</div>
<h6 id="decomposition">Decomposition<a class="headerlink" href="#decomposition" title="Permanent link"></a></h6>
<p>In its standard form, only full words match against the source. There
is a special notation to match the prefix and suffix of a word:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">~strasse =&gt; str</span><span class="w">  </span><span class="c1"># matches &quot;strasse&quot; as full word and in suffix position</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hinter~ =&gt; hntr</span><span class="w">  </span><span class="c1"># matches &quot;hinter&quot; as full word and in prefix position</span>
</code></pre></div>
<p>There is no facility to match a string in the middle of the word. The suffix
and prefix notation automatically trigger the decomposition mode: two variants
are created for each replacement, one with the replacement attached to the word
and one separate. So in above example, the tokenization of "hauptstrasse" will
create the variants "hauptstr" and "haupt str". Similarly, the name "rote strasse"
triggers the variants "rote str" and "rotestr". By having decomposition work
both ways, it is sufficient to create the variants at index time. The variant
rules are not applied at query time.</p>
<p>To avoid automatic decomposition, use the '|' notation:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">~strasse |=&gt; str</span>
</code></pre></div>
<p>simply changes "hauptstrasse" to "hauptstr" and "rote strasse" to "rote str".</p>
<h6 id="initial-and-final-terms">Initial and final terms<a class="headerlink" href="#initial-and-final-terms" title="Permanent link"></a></h6>
<p>It is also possible to restrict replacements to the beginning and end of a
name:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^south =&gt; s</span><span class="w">  </span><span class="c1"># matches only at the beginning of the name</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">road$ =&gt; rd</span><span class="w">  </span><span class="c1"># matches only at the end of the name</span>
</code></pre></div>
<p>So the first example would trigger a replacement for "south 45th street" but
not for "the south beach restaurant".</p>
<h6 id="replacements-vs-variants">Replacements vs. variants<a class="headerlink" href="#replacements-vs-variants" title="Permanent link"></a></h6>
<p>The replacement syntax <code>source =&gt; target</code> works as a pure replacement. It changes
the name instead of creating a variant. To create an additional version, you'd
have to write <code>source =&gt; source,target</code>. As this is a frequent case, there is
a shortcut notation for it:</p>
<div class="highlight"><pre><span></span><code>&lt;source&gt;[,&lt;source&gt;[...]] -&gt; &lt;target&gt;[,&lt;target&gt;[...]]
</code></pre></div>
<p>The simple arrow causes an additional variant to be added. Note that
decomposition has an effect here on the source as well. So a rule</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;~strasse</span><span class="nv"> </span><span class="s">-&gt;</span><span class="nv"> </span><span class="s">str&quot;</span>
</code></pre></div>
<p>means that for a word like <code>hauptstrasse</code> four variants are created:
<code>hauptstrasse</code>, <code>haupt strasse</code>, <code>hauptstr</code> and <code>haupt str</code>.</p>
<h6 id="mutations">Mutations<a class="headerlink" href="#mutations" title="Permanent link"></a></h6>
<p>The 'mutation' section in the configuration describes an additional set of
replacements to be applied after the variants have been computed.</p>
<p>Each mutation is described by two parameters: <code>pattern</code> and <code>replacements</code>.
The pattern must contain a single regular expression to search for in the
variant name. The regular expressions need to follow the syntax for
<a href="file:///usr/share/doc/python3-doc/html/library/re.html#regular-expression-syntax">Python regular expressions</a>.
Capturing groups are not permitted.
<code>replacements</code> must contain a list of strings that the pattern
should be replaced with. Each occurrence of the pattern is replaced with
all given replacements. Be mindful of combinatorial explosion of variants.</p>
<h6 id="modes">Modes<a class="headerlink" href="#modes" title="Permanent link"></a></h6>
<p>The generic analyser supports a special mode <code>variant-only</code>. When configured
then it consumes the input token and emits only variants (if any exist). Enable
the mode by adding:</p>
<div class="highlight"><pre><span></span><code>  mode: variant-only
</code></pre></div>
<p>to the analyser configuration.</p>
<h5 id="housenumber-token-analyzer">Housenumber token analyzer<a class="headerlink" href="#housenumber-token-analyzer" title="Permanent link"></a></h5>
<p>The analyzer <code>housenumbers</code> is purpose-made to analyze house numbers. It
creates variants with optional spaces between numbers and letters. Thus,
house numbers of the form '3 a', '3A', '3-A' etc. are all considered equivalent.</p>
<p>The analyzer cannot be customized.</p>
<h5 id="postcode-token-analyzer">Postcode token analyzer<a class="headerlink" href="#postcode-token-analyzer" title="Permanent link"></a></h5>
<p>The analyzer <code>postcodes</code> is pupose-made to analyze postcodes. It supports
a 'lookup' varaint of the token, which produces variants with optional
spaces. Use together with the clean-postcodes sanitizer.</p>
<p>The analyzer cannot be customized.</p>
<h3 id="reconfiguration">Reconfiguration<a class="headerlink" href="#reconfiguration" title="Permanent link"></a></h3>
<p>Changing the configuration after the import is currently not possible, although
this feature may be added at a later time.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../Importance/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Importance" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Importance
            </div>
          </div>
        </a>
      
      
        
        <a href="../Special-Phrases/" class="md-footer__link md-footer__link--next" aria-label="Next: Special Phrases" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Special Phrases
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Nominatim developer community
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>